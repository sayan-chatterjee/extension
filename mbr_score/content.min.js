var WEIGHTAGE_KEY="Weightage",RATING_KEY="Rating",SCORE_KEY="Score",STATUS_KEY="Status",STATUS_ACTIVE="Active",STATUS_DROP="Drop (Specify reason in 'Achievement so far' comment box)",STATUS_DROP_RTNG="Drop but considered for rating",MBR_SCORE_ELEM=$("div h2[title='MBR Annual Score']").parent().siblings("div").find("div[class='HRContentCell'] input"),CURRENT_STEP="sfcurrentstep";function getData(){var e=[],a=$("div[class='tabDataBorder']");return $.each(a,function(a,o){var t=$(o).find("table[class='goalDetailsTable']"),n={STATUS_KEY:"",WEIGHTAGE_KEY:0,RATING_KEY:0,SCORE_KEY:0};$.each(t,function(e,a){var o=$(a).find("tbody");$.each(o,function(e,a){var o=$(a).find("tr");$.each(o,function(e,a){var o=$(a).find("td[class='lab']").html(),t=$(a).find("td[class='val']").html();switch(o){case STATUS_KEY:n.STATUS_KEY=t;break;case WEIGHTAGE_KEY:n.WEIGHTAGE_KEY=parseFloat(t.replace("%",""));break;case RATING_KEY:n.RATING_KEY=parseFloat(t);break;case SCORE_KEY:n.SCORE_KEY=parseFloat(t)}})})}),e.push(n)}),e}function calculateScore(e){var a=0,o=0,t=0;e.forEach(e=>{console.log(e),a+=STATUS_DROP_RTNG===e.STATUS_KEY?e.WEIGHTAGE_KEY:0,o+=STATUS_ACTIVE===e.STATUS_KEY?e.RATING_KEY*e.WEIGHTAGE_KEY/100:0,t+=STATUS_ACTIVE===e.STATUS_KEY?e.WEIGHTAGE_KEY:0}),console.log("adjustment : ",a),console.log("mbr_score : ",o),console.log("total_active_wght : ",t);var n=0===t?0:o/t;console.log("weighted_avg_score : ",n);var E=n*(t+a);console.log("annual_mbr_score : ",E),MBR_SCORE_ELEM.val(E.toFixed(2))}$(document).ready(function(){console.log("Already Saved MBR Score :: ",MBR_SCORE_ELEM.val());var e=$("div#routeMap"),a=$(e).find("div[title='MBR Annual Review']");-1!=$(a).attr("class").toLowerCase().indexOf(CURRENT_STEP)?(console.log("Form in MBR Annual Review step..."),calculateScore(getData())):console.log("Form NOT in MBR Annual Review step...")});