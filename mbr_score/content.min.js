var WEIGHTAGE_KEY="Weightage",RATING_KEY="Rating",SCORE_KEY="Score",STATUS_KEY="Status",STATUS_ACTIVE="Active",STATUS_DROP="Drop (Specify reason in 'Achievement so far' comment box)",STATUS_DROP_RTNG="Drop but considered for rating",MBR_SCORE_ELEM=$("div h2[title='MBR Annual Score']").parent().siblings("div").find("div[class='HRContentCell'] input");function getData(){var a=[],e=$("div[class='tabDataBorder']");return $.each(e,function(e,o){var E=$(o).find("table[class='goalDetailsTable']"),t={STATUS_KEY:"",WEIGHTAGE_KEY:0,RATING_KEY:0,SCORE_KEY:0};$.each(E,function(a,e){var o=$(e).find("tbody");$.each(o,function(a,e){var o=$(e).find("tr");$.each(o,function(a,e){var o=$(e).find("td[class='lab']").html(),E=$(e).find("td[class='val']").html();switch(o){case STATUS_KEY:t.STATUS_KEY=E;break;case WEIGHTAGE_KEY:t.WEIGHTAGE_KEY=parseFloat(E.replace("%",""));break;case RATING_KEY:t.RATING_KEY=parseFloat(E);break;case SCORE_KEY:t.SCORE_KEY=parseFloat(E)}})})}),a.push(t)}),a}function calculateScore(a){var e=0,o=0,E=0;a.forEach(a=>{console.log(a),e+=STATUS_DROP_RTNG===a.STATUS_KEY?a.WEIGHTAGE_KEY:0,o+=STATUS_ACTIVE===a.STATUS_KEY?a.RATING_KEY*a.WEIGHTAGE_KEY/100:0,E+=STATUS_ACTIVE===a.STATUS_KEY?a.WEIGHTAGE_KEY:0}),console.log("adjustment : ",e),console.log("mbr_score : ",o),console.log("total_active_wght : ",E);var t=0===E?0:o/E;console.log("weighted_avg_score : ",t);var c=t*(E+e);console.log("annual_mbr_score : ",c),MBR_SCORE_ELEM.val(c.toFixed(2))}$(document).ready(function(){console.log("Already Saved MBR Score :: ",MBR_SCORE_ELEM.val()),calculateScore(getData())});