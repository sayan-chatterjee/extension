var EMPTY_STRING="",calculateButton='<div class=" pmFooterButtonSpacing"><span id="_calculate_span" class="buttonset sfDialogBoxButtonWrapper"><span><button style="background-color: azure;" class="globalRoundedCornersXSmall globalSecondaryButton buttonDefault" id="_calculate_button" type="button" accesskey="2">Calculate</button></span></span></div>',footerButtons=$("#footer_buttons_rev").html();function getQuarterId(){var t=$("div[class='sfStepsChartNameContainer'] div[class='sfStepsChartStepName sfStepsChartStepNamePosition']").html().toLowerCase();return-1!=t.indexOf("q1")?"#sect_3":-1!=t.indexOf("q2")?"#sect_4":-1!=t.indexOf("q3")?"#sect_5":-1!=t.indexOf("q4")?"#sect_6":void 0}function createKraList(t,e){for(var a=[],l="Achievement (RA)".toLowerCase(),n="Achievement (Employee)".toLowerCase(),o=!1,r=0;r<t.length;r++){var s=!1,c={goalWeightage:0,raInput:0,empInput:0},u=$(t[r]).find("td[class='lab']").html().toLowerCase(),i=$(t[r]).find("td[class='val']").html();"goal weightage"===u&&(i=null==i||EMPTY_STRING===i?"0.00%":i,c.goalWeightage=parseFloat(i.replace("%","")),s=!0,o=!0),-1!=u.indexOf(l)&&o&&(i=null==i||EMPTY_STRING===i?"0.00%":i,(c=a.pop()).raInput=parseFloat(i.replace("%","")),s=!0,o=!1),s&&a.push(c)}var p=0;for(r=0;r<e.length;r++){var f=$(e[r]).find("td[class='lab']").html().toLowerCase(),d=$(e[r]).find("td[class='val']").html();-1!=f.indexOf(n)&&(d=null==d||EMPTY_STRING===d?"0.00%":d,a[p++].empInput=parseFloat(d.replace("%","")))}return a}function calculateAchievement(t){for(var e=0,a=0,l=0;l<t.length;l++){var n=t[l].goalWeightage;e+=n*t[l].empInput,a+=n*t[l].raInput}return{empActual:(e/100).toFixed(2),raActual:(a/100).toFixed(2)}}$("#footer_buttons_rev").html(calculateButton+footerButtons),$("#_calculate_button").click(function(){for(var t=getQuarterId(),e=$(t),a=e.find("div[class='leftTabs']"),l=e.find("div[class='rightTabs']"),n=[],o=[],r=0;r<a.length;r++)for(var s=$(a[r]).find("tr[class='propTable']"),c=0;c<s.length;c++)n.push(s[c]);for(r=0;r<l.length;r++){var u=$(l[r]).find("tr[class='propTable']");for(c=0;c<u.length;c++)o.push(u[c])}var i=calculateAchievement(createKraList(n,o));$("#wf_sect_7_e_0").val(i.empActual+" %"),$("#wf_sect_8_e_ele_10").val(i.raActual+" %")});